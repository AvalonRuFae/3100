\documentclass[11pt,a4paper]{article}
\usepackage[margin=1in]{geometry}
\usepackage{hyperref}
\usepackage{graphicx}
\usepackage{longtable}
\usepackage{booktabs}
\usepackage{enumitem}
\usepackage{fancyhdr}
\usepackage{titlesec}
\usepackage{xcolor}
\usepackage{listings}
\usepackage{caption}

% Header and footer
\pagestyle{fancy}
\fancyhf{}
\fancyhead[L]{Testing Documentation}
\fancyhead[R]{DSCPMS}
\fancyfoot[C]{\thepage}

% Section formatting
\titleformat{\section}{\Large\bfseries}{\thesection}{1em}{}
\titleformat{\subsection}{\large\bfseries}{\thesubsection}{1em}{}
\titleformat{\subsubsection}{\normalsize\bfseries}{\thesubsubsection}{1em}{}

% Code listing settings
\lstset{
    basicstyle=\ttfamily\small,
    breaklines=true,
    frame=single,
    backgroundcolor=\color{gray!10}
}

% Colors
\definecolor{linkcolor}{RGB}{0,0,255}
\hypersetup{
    colorlinks=true,
    linkcolor=linkcolor,
    urlcolor=linkcolor,
    citecolor=linkcolor
}

\begin{document}

% Title Page
\begin{titlepage}
    \centering
    \vspace*{2cm}
    
    {\Huge\bfseries Testing Documentation\par}
    \vspace{1cm}
    {\Large Demon Slayer Corps Project Management System (DSCPMS)\par}
    \vspace{2cm}
    
    {\large
    \textbf{Document Version:} 1.0\\[0.3cm]
    \textbf{Last Updated:} December 22, 2025\\[0.3cm]
    \textbf{Backend Testing Framework:} Jest + Supertest\\[0.3cm]
    \textbf{Frontend Testing Framework:} User Requirement Testing\\[0.3cm]
    \textbf{Node.js Version:} 16+
    }
    
    \vfill
    
    {\large Prepared by: DSCPMS Development Team\par}
    {\large Status: Approved for Development Use\par}
    
\end{titlepage}

% Table of Contents
\tableofcontents
\newpage

% Main Content
\section{Test Plan Overview}

\subsection{Purpose}
This test plan outlines the comprehensive testing strategy for the DSCPMS, encompassing both backend unit testing and frontend user requirement testing to ensure system reliability, security, and compliance with functional requirements specified in the Software Requirements Specification (SRS).

\subsection{Scope}

\subsubsection{Backend Testing (Unit \& Integration Tests)}
The backend testing covers:
\begin{itemize}
    \item RESTful API endpoints
    \item Authentication and authorization mechanisms
    \item Database operations and data integrity
    \item Business logic in service layer
    \item Role-based access control (RBAC)
    \item License validation system
    \item Bounty reward and penalty mechanisms
    \item Team management functionality
\end{itemize}

\subsubsection{Frontend Testing (User Requirement Tests)}
The frontend testing covers:
\begin{itemize}
    \item User interface functionality and workflows
    \item User requirement validation
    \item End-to-end user scenarios
    \item Compliance with SRS functional requirements
\end{itemize}

\subsection{Testing Objectives}
\begin{itemize}
    \item Verify all functional requirements from SRS are implemented correctly
    \item Ensure data security and proper authentication/authorization
    \item Validate business rules and constraints
    \item Test error handling and edge cases
    \item Confirm database integrity and transaction handling
    \item Validate API response formats and status codes
\end{itemize}

\subsection{Test Deliverables}
\begin{itemize}
    \item Automated test suites for all major components
    \item Test coverage reports (target: 70\%+ for critical paths)
    \item Test execution logs and results
    \item Bug reports and resolution tracking
\end{itemize}

\section{Testing Strategy}

\subsection{Testing Approach}

\subsubsection{Backend Unit Testing}
\textbf{Purpose:} Test backend API, business logic, and data layer in isolation

\textbf{Scope:}
\begin{itemize}
    \item Individual API endpoints and controllers
    \item Service layer business logic
    \item Database operations and models
    \item Middleware components
    \item Authentication and authorization
    \item Utility functions
\end{itemize}

\textbf{Approach:}
\begin{itemize}
    \item Mock external dependencies (database, services)
    \item Test API endpoints with Supertest
    \item Validate request/response formats
    \item Test error handling and edge cases
    \item Verify data integrity and transactions
    \item Test security mechanisms (JWT, password hashing)
\end{itemize}

\textbf{Tools:} Jest + Supertest

\textbf{Coverage Target:} 70\%+ for critical paths

\subsubsection{Frontend User Requirement Testing}
\textbf{Purpose:} Validate that the frontend meets user requirements and SRS specifications

\textbf{Scope:}
\begin{itemize}
    \item User workflows and scenarios from SRS
    \item Functional requirements validation
    \item User interface interactions
    \item End-to-end user journeys
    \item Role-based feature access
\end{itemize}

\textbf{Approach:}
\begin{itemize}
    \item Manual testing against SRS requirements
    \item User acceptance testing (UAT)
    \item Scenario-based testing
    \item Role-based workflow validation
    \item Requirement traceability verification
\end{itemize}

\textbf{Tools:} Manual testing, requirement checklists

\textbf{Coverage Target:} 100\% of SRS functional requirements

\subsection{Testing Types}

\subsubsection{Functional Testing}
Tests that verify system behavior matches requirements:
\begin{itemize}
    \item User registration and authentication
    \item Task creation, assignment, and lifecycle
    \item Bounty calculation and distribution
    \item License validation and team management
    \item Notification generation
\end{itemize}

\subsubsection{Security Testing}
Tests that verify system security:
\begin{itemize}
    \item Password hashing (bcrypt)
    \item JWT token generation and validation
    \item Authorization checks for protected routes
    \item SQL injection prevention
    \item Input validation and sanitization
\end{itemize}

\subsubsection{Negative Testing}
Tests that verify system handles invalid inputs:
\begin{itemize}
    \item Invalid credentials
    \item Malformed requests
    \item Unauthorized access attempts
    \item Expired tokens
    \item Invalid data formats
\end{itemize}

\subsubsection{Data Integrity Testing}
Tests that verify database consistency:
\begin{itemize}
    \item Foreign key constraints
    \item Unique constraints
    \item Transaction rollbacks
    \item Cascade deletions
\end{itemize}

\section{Test Coverage}

\subsection{Components Covered}

\subsubsection{Authentication System (auth.test.js)}
\textbf{Coverage:} $>$90\%

\textbf{Test Count:} 41 test cases

\textbf{Key Areas:}
\begin{itemize}
    \item User registration with duplicate detection and validation
    \item Login with JWT generation and team/license checks
    \item Password change functionality and validation
    \item Token-based authentication and authorization
    \item Protected route access control
    \item JWT structure and 8-hour expiration enforcement
\end{itemize}

\subsubsection{Task Management System (tasks.test.js)}
\textbf{Coverage:} $>$85\%

\textbf{Test Count:} 24 test cases

\textbf{Key Areas:}
\begin{itemize}
    \item Task creation with required fields
    \item Task assignment to qualified users
    \item Kanban board filtering by status
    \item Status update by assigned users
    \item Deadline management
    \item Task deletion permissions
\end{itemize}

\subsubsection{License Management System (license.test.js)}
\textbf{Coverage:} $>$90\%

\textbf{Test Count:} 47 test cases

\textbf{Key Areas:}
\begin{itemize}
    \item License-based access control
    \item License key validation
    \item Team-based license assignment
    \item Task creation limits for unlicensed teams
\end{itemize}

\subsubsection{User Management (user.test.js)}
\textbf{Coverage:} $>$70\%

\textbf{Test Count:} 43 test cases

\textbf{Key Areas:}
\begin{itemize}
    \item User CRUD operations with role-based authorization
    \item Profile updates and validation (email, username uniqueness)
    \item User status management (active/inactive)
    \item Balance precision and tracking
    \item Security testing (SQL injection, XSS, password exclusion)
    \item Edge case handling (concurrent updates, null values, invalid IDs)
\end{itemize}

\subsubsection{Bounty System (bounty.test.js)}
\textbf{Coverage:} $>$90\%

\textbf{Test Count:} 14 test cases

\textbf{Key Areas:}
\begin{itemize}
    \item Bounty reward system
    \item Penalty system
    \item Financial transaction logging
\end{itemize}

\subsubsection{Notification System (notifications.test.js)}
\textbf{Coverage:} $>$90\%

\textbf{Test Count:} 41 test cases

\textbf{Key Areas:}
\begin{itemize}
    \item Task notifications
    \item Administrative notifications
\end{itemize}

\subsubsection{Team Management (team.test.js)}
\textbf{Coverage:} $\sim$71\%

\textbf{Test Count:} 20 test cases

\textbf{Key Areas:}
\begin{itemize}
    \item Team-based project organization
    \item License-to-team binding
    \item Team member permissions
\end{itemize}

\subsubsection{Database Connection (database.test.js)}
\textbf{Coverage:} $\sim$100\%

\textbf{Test Count:} 49 test cases

\section{Representative Test Cases}

\subsection{Authentication \& Authorization}

\subsubsection{TC-AUTH-001: User Registration with team\_id=NULL}
\textbf{Objective:} Verify new users register with team\_id=NULL per auth\_flow.puml specification

\textbf{Test Category:} Functional Testing \\
\textbf{Priority:} High \\
\textbf{Related Requirement:} REQ-1

\textbf{Test Steps:}
\begin{enumerate}
    \item Send POST request to \texttt{/api/v1/auth/register} with test data
    \item Verify response status code is 201
    \item Verify response body has \texttt{success: true}
    \item Verify response data contains user \texttt{id} and \texttt{username}
    \item Query database using \texttt{User.findByPk()} to retrieve created user
    \item Assert \texttt{user.teamId} is \texttt{null}
\end{enumerate}

\textbf{Expected Results:}
\begin{itemize}
    \item HTTP 201 Created status
    \item Response contains user data with \texttt{teamId: null}
    \item Database verification confirms \texttt{teamId = NULL}
    \item User can later join/create teams
\end{itemize}

\subsubsection{TC-AUTH-002: Login with Team Check}
\textbf{Objective:} Verify login returns JWT token and sets no\_team flag when user has no team

\textbf{Test Category:} Functional Testing \\
\textbf{Priority:} High \\
\textbf{Related Requirement:} REQ-2

\textbf{Test Steps:}
\begin{enumerate}
    \item Send POST request to \texttt{/api/v1/auth/login} with credentials
    \item Verify response status is 200
    \item Extract JWT token from response
    \item Verify \texttt{no\_team} flag in response
    \item Decode JWT to verify payload structure
    \item Use token to access protected route
\end{enumerate}

\textbf{Expected Results:}
\begin{itemize}
    \item HTTP 200 OK status
    \item JWT token valid for authentication
    \item Token contains user ID, role, and teamId (null)
\end{itemize}

\subsubsection{TC-AUTH-003: Role-Based Access Control}
\textbf{Objective:} Verify role-based permissions are enforced

\textbf{Test Category:} Security Testing \\
\textbf{Priority:} High \\
\textbf{Related Requirement:} REQ-3

\begin{table}[h]
\centering
\small
\begin{tabular}{lccc}
\toprule
\textbf{Action} & \textbf{GOON} & \textbf{HASHIRA} & \textbf{OYAKATASAMA} \\
\midrule
Create Task & \texttimes & \checkmark & \checkmark \\
Assign Task & \checkmark & \checkmark & \checkmark \\
Update Task Status & \checkmark (own) & \checkmark (own) & \checkmark (any) \\
Delete Task & \texttimes & \checkmark & \checkmark \\
Manage Users & \texttimes & \texttimes & \checkmark \\
\bottomrule
\end{tabular}
\caption{Role-based permissions matrix}
\end{table}

\subsection{Task Management}

\subsubsection{TC-TASK-001: Hashira Can Create Tasks}
\textbf{Objective:} Verify users with HASHIRA role can create tasks with required fields

\textbf{Test Category:} Functional Testing + Authorization \\
\textbf{Priority:} High \\
\textbf{Related Requirement:} REQ-5

\textbf{Test Steps:}
\begin{enumerate}
    \item Authenticate as Hashira user and get token
    \item Send POST to \texttt{/api/v1/tasks} with Authorization header
    \item Include valid task data in request body
    \item Verify response status is 201
    \item Verify response includes task ID and all submitted fields
    \item Query database to confirm task created
    \item Verify \texttt{createdBy} field set to Hashira user ID
    \item Verify task status defaults to "AVAILABLE"
\end{enumerate}

\textbf{Expected Results:}
\begin{itemize}
    \item HTTP 201 Created
    \item Task stored with correct creator ID
    \item Initial status: AVAILABLE
\end{itemize}

\subsubsection{TC-TASK-002: GOON Cannot Create Tasks}
\textbf{Objective:} Verify GOON role users are forbidden from creating tasks

\textbf{Test Category:} Authorization Testing \\
\textbf{Priority:} High \\
\textbf{Related Requirement:} REQ-3, REQ-5

\textbf{Expected Results:}
\begin{itemize}
    \item HTTP 403 Forbidden
    \item No task record created in database
    \item Clear error messaging for role requirements
\end{itemize}

\subsubsection{TC-TASK-003: Task Status Update}
\textbf{Objective:} Verify assigned users can update task status through workflow states

\textbf{Expected Results:}
\begin{itemize}
    \item HTTP 200 OK for valid status updates
    \item Status transitions follow workflow rules
    \item Unauthorized users receive 403 Forbidden
    \item Invalid transitions rejected with clear error
\end{itemize}

\subsection{License Management}

\subsubsection{TC-LICENSE-001: Expired License Rejected}
\textbf{Objective:} Verify license keys with past expiry dates are rejected

\textbf{Test Category:} Security Testing \\
\textbf{Priority:} High \\
\textbf{Related Requirement:} REQ-4

\textbf{Expected Results:}
\begin{itemize}
    \item Expired licenses blocked from use
    \item Team creation prevented
    \item Clear error messaging about expiration
\end{itemize}

\subsubsection{TC-LICENSE-002: Invalid License Rejected}
\textbf{Objective:} Verify license keys not in environment config are rejected

\textbf{Expected Results:}
\begin{itemize}
    \item Team creation fails with 400 Bad Request
    \item No team or license records created
    \item Clear error message guides user to obtain valid license
\end{itemize}

\subsection{Bounty System}

\subsubsection{TC-BOUNTY-001: Statistics Aggregation}
\textbf{Objective:} Verify correct aggregation of total bounties, penalties, and transaction counts

\textbf{Test Category:} Functional Testing + Data Aggregation \\
\textbf{Priority:} High \\
\textbf{Related Requirement:} REQ-11

\textbf{Expected Results:}
\begin{itemize}
    \item Statistics correctly sum all transaction amounts
    \item Bounty and penalty counts accurate
    \item Decimal precision maintained (2 decimal places)
\end{itemize}

\subsubsection{TC-BOUNTY-002: Transaction History}
\textbf{Objective:} Verify user's complete transaction history is returned

\textbf{Expected Results:}
\begin{itemize}
    \item All user transactions returned
    \item Transaction amounts correctly signed
    \item Complete audit trail maintained
\end{itemize}

\subsection{Team Management}

\subsubsection{TC-TEAM-001: Team Creation with License}
\textbf{Objective:} Verify team creation flow with valid license key

\textbf{Test Category:} Integration Testing \\
\textbf{Priority:} High \\
\textbf{Related Requirement:} REQ-4

\textbf{Expected Results:}
\begin{itemize}
    \item Team record created in database
    \item License record created with teamId reference
    \item User automatically becomes team member
    \item License validation executed before creation
\end{itemize}

\subsection{User Management}

\subsubsection{TC-USER-001: Team Isolation}
\textbf{Objective:} Verify users can only see profiles within their team

\textbf{Test Category:} Security Testing + Authorization \\
\textbf{Priority:} High \\
\textbf{Related Requirement:} REQ-10

\textbf{Expected Results:}
\begin{itemize}
    \item Cross-team profile access blocked or limited
    \item Same-team profile access granted
    \item Clear error message for unauthorized access
\end{itemize}

\subsection{Notification System}

\subsubsection{TC-NOTIF-001: Task Assignment Notification}
\textbf{Objective:} Verify notifications are created when tasks are assigned

\textbf{Test Category:} Functional Testing + Event-Driven \\
\textbf{Priority:} Medium \\
\textbf{Related Requirement:} REQ-14

\textbf{Expected Results:}
\begin{itemize}
    \item New notification created with proper type
    \item Notification includes task details
    \item Notification visible only to assigned user
    \item Initial read status is false
\end{itemize}

\section{Testing Environment}

\subsection{Docker Setup (Required)}

\textbf{IMPORTANT:} All tests must be run inside Docker containers to ensure proper database connectivity and environment consistency.

\subsubsection{Prerequisites}
\begin{itemize}
    \item Docker and Docker Compose installed
    \item All containers started via Docker Compose
\end{itemize}

\subsubsection{Setup Steps}

\textbf{1. Start the Docker environment:}
\begin{lstlisting}[language=bash]
# Navigate to project root
cd c:\Users\user\Documents\GitHub\3100

# Start database and backend containers
docker-compose up -d database backend
\end{lstlisting}

\textbf{2. Verify containers are running:}
\begin{lstlisting}[language=bash]
docker ps
# Should show: dscpms-database and dscpms-backend containers
\end{lstlisting}

\textbf{3. Create test database (one-time setup):}
\begin{lstlisting}[language=bash]
docker exec dscpms-database mysql -u root -proot -e "CREATE DATABASE IF NOT EXISTS dscpms_test;"
\end{lstlisting}

\subsection{Test Execution}

\textbf{CRITICAL:} Tests must be executed inside the Docker backend container, NOT on the host machine.

\subsubsection{Run Individual Test Suites}
\begin{lstlisting}[language=bash]
# Auth tests
docker exec dscpms-backend bash -c "NODE_ENV=test npm test -- auth.test.js --forceExit"

# Task tests
docker exec dscpms-backend bash -c "NODE_ENV=test npm test -- tasks.test.js --forceExit"

# License tests
docker exec dscpms-backend bash -c "NODE_ENV=test npm test -- license.test.js --forceExit"

# User tests
docker exec dscpms-backend bash -c "NODE_ENV=test npm test -- user.test.js --forceExit"
\end{lstlisting}

\subsection{Test Database Configuration}

The test environment uses Docker's internal networking with the following configuration:

\begin{itemize}
    \item \texttt{DB\_HOST=database} (Docker service name, not 'localhost')
    \item \texttt{DB\_PORT=3306}
    \item \texttt{DB\_USER=root}
    \item \texttt{DB\_PASSWORD=root}
    \item \texttt{NODE\_ENV=test} (triggers test database usage)
\end{itemize}

\section{Test Metrics and Reporting}

\subsection{Current Test Metrics}
\begin{itemize}
    \item \textbf{Total Test Cases:} 279
    \item \textbf{Passing Tests:} 279 (100\%)
    \item \textbf{Code Coverage:} $\sim$86\% overall
    \begin{itemize}
        \item Authentication: $\sim$90\%
        \item Tasks: $\sim$85\%
        \item License: $\sim$90\%
        \item User: $\sim$70\%
        \item Bounty: $\sim$90\%
        \item Notifications: $\sim$90\%
        \item Team: $\sim$71\%
        \item Database: $\sim$100\%
    \end{itemize}
    \item \textbf{Average Test Execution Time:} 45 seconds
    \item \textbf{Test Reliability:} 100\% (no flaky tests)
\end{itemize}

\subsection{Coverage Goals}
\begin{itemize}
    \item Critical paths (auth, task, bounty): \textbf{90\%+} \checkmark
    \item Business logic (services): \textbf{85\%+} \checkmark
    \item API endpoints: \textbf{90\%+} \checkmark
    \item Error handling: \textbf{80\%+} \checkmark
\end{itemize}

\subsection{Quality Gates}
Before merging code:
\begin{itemize}
    \item All tests must pass
    \item No decrease in code coverage
    \item No new ESLint errors
    \item API documentation updated
    \item Test cases added for new features
\end{itemize}

\section{Conclusion}

The DSCPMS testing strategy provides comprehensive coverage of critical functionality through automated unit and integration tests. The test suite validates all major requirements from the SRS, ensures security through authentication and authorization tests, and maintains data integrity through database transaction testing.

\subsection{Key Achievements}
\begin{itemize}
    \item 279 automated test cases covering core functionality
    \item 86\% code coverage with focus on critical paths
    \item All SRS requirements validated
    \item Security testing for authentication and authorization
    \item Business rule validation for bounty and license systems
    \item Comprehensive error handling verification
\end{itemize}

\subsection{Testing Infrastructure}
\begin{itemize}
    \item Jest framework with Supertest for API testing
    \item Isolated test database for data integrity
    \item Mock external dependencies for reliable testing
    \item Fast execution ($<$1 minute for full suite)
\end{itemize}

\vspace{1cm}

\noindent\textbf{Document Approval:}

\noindent\textbf{Prepared by:} DSCPMS Development Team \\
\textbf{Review Date:} December 22, 2025 \\
\textbf{Status:} Approved for Development Use

\end{document}
